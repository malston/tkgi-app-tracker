# TKGI Application Tracker - Excel Template Guide

## Overview

The TKGI Application Tracker generates comprehensive Excel workbooks with pivot tables, charts, and professional formatting for executive and management analysis. These workbooks transform raw application data into actionable business intelligence.

## Features

### Excel Workbook Components

#### 1. **Applications Sheet** - Raw Data with Formatting

- Complete application inventory with professional styling
- Optimized column widths and data types
- Conditional formatting for quick insights
- Ready for pivot table creation

#### 2. **Executive Dashboard** - Management Summary

- Key performance indicators (KPIs)
- Foundation-level summaries
- Migration readiness metrics
- Visual metric cards with corporate styling

#### 3. **Charts & Analysis** - Visual Insights

- Application status distribution (pie charts)
- Migration readiness score analysis (bar charts)
- Environment breakdown visualizations
- Foundation comparison charts

#### 4. **Pivot Table Instructions** - Step-by-Step Guide

- Detailed instructions for creating powerful pivot tables
- Pre-configured analysis scenarios
- Filter and slicer recommendations
- Best practices for data exploration

#### 5. **Trend Analysis** - Historical Tracking

- Template for weekly trend tracking
- Automated formulas for migration progress
- Line charts for visualization
- 12-week historical comparison

## Generation Methods

### Method 1: Integrated with Report Generation

```bash
# Generate CSV reports first, then Excel workbook
make docker-test TASK=generate-reports
make excel-reports

# Or using convenience script
./scripts/generate-excel.sh
```

### Method 2: Standalone Excel Generation

```bash
# Generate Excel workbook from existing CSV data
./scripts/generate-excel.sh

# Generate with custom output directory
./scripts/generate-excel.sh -o /tmp/excel-reports

# Generate template workbook without data
./scripts/generate-excel.sh --template-only

# Verbose execution
./scripts/generate-excel.sh -v
```

### Method 3: Using Python Script Directly

```bash
# Generate workbook with data
python3 scripts/generate-excel-template.py --output-dir reports

# Generate template only
python3 scripts/generate-excel-template.py --template-only

# Verbose output
python3 scripts/generate-excel-template.py --verbose
```

## Excel Analysis Workflows

### Executive Management Workflow

1. **Open the Excel workbook** generated by the system
2. **Review Executive Dashboard** for high-level metrics
3. **Examine Charts & Analysis** sheet for visual insights
4. **Create custom pivot tables** using the Applications data:

**Pivot Table 1: Application Status by Environment**

- Rows: Environment (Production, Non-Production)
- Columns: Status (Active, Inactive)
- Values: Count of Applications
- Result: Shows migration candidates by environment

**Pivot Table 2: Foundation Utilization Analysis**

- Rows: Foundations
- Values: Sum of Total Pods, Sum of Running Pods
- Calculated Field: Utilization % = Running Pods / Total Pods
- Result: Infrastructure utilization by foundation

### Migration Planning Workflow

1. **Filter for Migration Candidates**
   - Use Migration Priority sheet data
   - Focus on scores 60-100 (migration ready)
   - Filter by environment (Production vs Non-Production)

2. **Create Migration Timeline Pivot**
   - Rows: Migration Readiness Score (grouped: 80-100, 60-79, 40-59, 0-39)
   - Columns: Environment
   - Values: Count of Applications
   - Result: Migration complexity distribution

3. **Analyze Resource Impact**
   - Use Total Pods and Services columns
   - Create scatter plot: Pod Count vs Migration Score
   - Identify high-impact migrations

### Operations Dashboard Workflow

1. **Create Cluster Health Overview**
   - Use Applications data
   - Rows: Clusters
   - Values: Count of Namespaces, Sum of Running Pods
   - Add conditional formatting for utilization levels

2. **Inactive Application Analysis**
   - Filter Status = "Inactive"
   - Group by Days Since Activity (0-30, 31-60, 61-90, 90+)
   - Identify decommissioning candidates

## Advanced Excel Features

### Pivot Table Recommendations

#### Application Health Matrix

```
Rows: Environment
Columns: Status
Values: Count of Application ID
Filter: Migration Readiness Score >= 60
```

#### Foundation Resource Distribution

```
Rows: Foundations
Columns: Environment
Values: Sum of Total Pods
```

#### Migration Complexity Assessment

```
Rows: Migration Readiness Score (Grouped)
Values: Count of Applications, Average of Total Pods
```

### Chart Types and Usage

#### Pie Charts

- **Application Status Distribution**: Active vs Inactive
- **Environment Split**: Production vs Non-Production
- **Foundation Distribution**: Applications per foundation

#### Bar Charts

- **Migration Readiness Scores**: Distribution across score ranges
- **Resource Utilization**: Pods and services by foundation
- **Timeline Analysis**: Applications by last activity period

#### Line Charts (Trend Analysis Sheet)

- **Weekly Migration Progress**: Applications migrated over time
- **Activity Trends**: Active application count by week
- **Migration Velocity**: Rate of successful migrations

### Conditional Formatting Rules

Apply these formatting rules to highlight key insights:

#### Application Status

- **Green**: Migration Score >= 80
- **Yellow**: Migration Score 60-79
- **Orange**: Migration Score 40-59
- **Red**: Migration Score < 40

#### Activity Status

- **Red**: Inactive > 90 days (decommission candidates)
- **Yellow**: Inactive 31-90 days
- **Green**: Active applications

#### Environment Classification

- **Blue Background**: Production applications
- **Light Gray**: Non-production applications

### Slicers for Interactive Analysis

Add slicers for dynamic filtering:

- **Environment** (Production, Non-Production, Mixed)
- **Foundation** (DC01, DC02, DC03, DC04)
- **Status** (Active, Inactive)
- **Migration Readiness** (Ready 80+, Planning 60-79, Complex <60)

## Data Refresh Procedures

### Weekly Data Update Process

1. **Generate Fresh Reports**

   ```bash
   ./scripts/run-full.sh -f dc01-k8s-n-01
   ./scripts/generate-reports.py --excel
   ```

2. **Update Excel Workbook**
   - Copy new data to Applications sheet
   - Right-click any pivot table â†’ Refresh All
   - Charts will automatically update

3. **Validate Data Quality**
   - Check for data completeness
   - Verify foundation count matches expectations
   - Review migration readiness distribution

### Historical Trend Maintenance

1. **Update Trend Analysis Sheet**
   - Add new week's data to trend template
   - Formulas will calculate deltas automatically
   - Charts will extend to include new data point

2. **Archive Previous Reports**
   - Save previous week's workbook with date suffix
   - Maintain 12-week rolling archive
   - Document significant changes or anomalies

## Troubleshooting

### Common Issues

#### 1. Excel Generation Fails

```bash
# Error: openpyxl not available
pip3 install -r requirements.txt

# Error: CSV files not found
./scripts/generate-reports.py  # Generate CSV first
```

#### 2. Pivot Tables Not Working

- Ensure data is in table format (Ctrl+T)
- Check for merged cells in data range
- Verify column headers are unique

#### 3. Charts Not Displaying

- Check data references point to correct sheets
- Ensure data types are consistent
- Verify chart data ranges

#### 4. Formulas Not Calculating

- Check that Excel is set to automatic calculation
- Verify cell references are correct
- Look for circular references

### Performance Optimization

#### Large Dataset Handling

- Use pivot tables instead of formulas for large datasets
- Limit conditional formatting to essential ranges
- Consider splitting data across multiple sheets

#### Memory Management

- Close unnecessary workbooks
- Use 64-bit Excel for large datasets
- Consider using Excel's Data Model for very large datasets

## Integration Examples

### PowerBI Integration

Export data to PowerBI for advanced analytics:

1. Use the generated JSON reports
2. Import into PowerBI Desktop
3. Create interactive dashboards
4. Schedule automated refresh

### Teams Integration

Share insights via Microsoft Teams:

1. Export key charts as images
2. Use webhook notifications for weekly reports
3. Pin dashboard to Teams channel

### SharePoint Integration

Store and share workbooks:

1. Upload to SharePoint document library
2. Set up automated workflows
3. Enable co-authoring for team analysis

## Best Practices

### Data Governance

- Maintain consistent naming conventions
- Document data definitions and calculations
- Establish clear data ownership
- Regular data quality reviews

### Report Distribution

- Schedule automated generation and distribution
- Create executive summary versions
- Maintain audit trail of reports
- Version control for workbook templates

### Security Considerations

- Protect sensitive sheets
- Use read-only distribution for management
- Implement access controls on SharePoint
- Regular backup of historical data

## Template Customization

### Adding Custom Metrics

1. **Modify Excel Generator Script**

   ```python
   # Add custom columns to CSV generation
   custom_columns = ['Custom Metric', 'Business Unit', 'Cost Center']
   ```

2. **Update Pivot Table Instructions**
   - Document new analysis scenarios
   - Add custom chart types
   - Update slicer recommendations

3. **Enhance Dashboard Design**
   - Add company branding
   - Customize color schemes
   - Include corporate KPIs

### Creating Department-Specific Views

1. **Filter by Business Context**
   - Add business unit metadata
   - Create department-specific sheets
   - Customize metrics per audience

2. **Automated Distribution Lists**
   - Generate role-specific workbooks
   - Schedule distribution timing
   - Customize content per recipient

This comprehensive Excel template system transforms raw TKGI application data into executive-ready business intelligence, enabling data-driven migration planning and resource optimization decisions.
